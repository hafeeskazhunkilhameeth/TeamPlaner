{% extends "templates/web.html" %}

{% block title %}{{ _("Trainings") }}{% endblock %}
{% block header %}<h1>{{ _("Trainings") }}</h1>{% endblock %}

{% block page_sidebar %}
{% include "templates/pages/web_sidebar.html" %}
{% endblock %}

{% block page_content %}
<div class="panel-group" id="accordion">
{% for training in trainings %}
	{% set stundensperre = frappe.utils.date_diff(training.name, frappe.utils.now()) %}
	<div class="panel panel-default">
		<div class="panel-heading">
		  <h4 class="panel-title">
			<a data-toggle="collapse" data-parent="#accordion" href="#{{ training.name }}">
			{{ training.beschriftung }} ({{ teilnehmer[training.name] }}) - {{ training.ort or 'Ort nicht definiert' }}</a>
		  </h4>
		</div>
		<div id="{{ training.name }}" class="panel-collapse collapse">
		  <div class="panel-body">
			<table style="width: 100%">
				<tr>
					<td><i class="fa fa-bell"></i> von {{ training.von }} bis {{ training.bis }}<br>&nbsp;<i class="fa fa-map-marker"></i> {{ training.ort or 'Keine Angabe' }}</td>
				</tr>
			</table>
			<h4>Teilnehmer</h4>
			<table style="width: 100%">
				{% for sp in spieler[training.name] %}
				<tr {% if stundensperre >= 1 %}{% if sp[3] == frappe.session.user %}onclick="change_anwesenheit('{{ training.name }}', frappe.session.user, '{{ sp[2] }}', this);" {% endif %}{% endif %}style="{% if sp[2] == 'Anwesend' %}background-color: #50D050;{% else %}background-color: red;{% endif %}{% if sp[3] == frappe.session.user %} border: dotted;{% endif %}">
					<td style="width: 10%; height: 30px;">&nbsp;{% if sp[3] == frappe.session.user %}{% if stundensperre >= 1 %}<i class="fa fa-exchange"></i>{% else %}<i class="fa fa-hourglass-end"></i>{% endif %}{% else %}{% if sp[2] == 'Anwesend' %}<i class="fa fa-check-circle"></i>{% else %}<i class="fa fa-times-circle"></i>{% endif %}{% endif %}</td>
					<td style="width 90%; height: 30px;">{{ sp[0] }} {{ sp[1] }}</td>
				</tr>
				{% endfor %}
			</table>
		  </div>
		</div>
	 </div>
{% endfor %}
</div> 
{% endblock %}



